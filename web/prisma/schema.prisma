generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

enum Category {
  GROCERIES
  DINING
  TRANSPORTATION
  ENTERTAINMENT
  SHOPPING
  UTILITIES
  HEALTHCARE
  EDUCATION
  TRAVEL
  SUBSCRIPTIONS
  PERSONAL_CARE
  RENT
  INSURANCE
  INCOME
  MISC
}

model User {
  id    String @id @default(uuid())
  email String @unique

  firstName String? @map("first_name")
  lastName  String? @map("last_name")

  createdAt DateTime @default(now()) @map("created_at")

  records Transaction[]
  Item    Item[]

  @@map("users")
}

model Transaction {
  id       String   @id @default(uuid())
  store    String
  category Category
  imageUrl String   @map("image_url")
  address  String   @default("")
  phone    String   @default("")

  notes String?

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  user   User?   @relation(fields: [userId], references: [id])
  userId String?

  items Item[] @relation("TransactionItems")

  @@map("records")
}

model Item {
  id String @id @default(uuid())

  name String
  cost Float

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  user   User?   @relation(fields: [userId], references: [id])
  userId String? @map("user_id")

  transactions Transaction[] @relation("TransactionItems")

  @@map("items")
}
